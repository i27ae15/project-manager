<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Boostrap -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>
    
    {% load static %}

    <!-- My js -->
    <script src="{% static '/assets/js/chat.js' %}" defer></script>
    <script src="{% static '/assets/js/main.js' %}"></script>

    <!-- Jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- css -->
    <link id="pagestyle" rel="stylesheet" href="{% static '/assets/css/soft-ui-dashboard.css' %}">
    <link id="my-css" rel="stylesheet" href="{% static '/assets/css/my-css.css' %}">
    <link rel="stylesheet" href="{% static '/assets/css/chat.css' %}">

</head>

<body>
    <main class="content">
        <div class="container p-0" style="max-width: 1305px;">
            <div class="card">
                <div class="row g-0">
                    <div class="col-12 col-lg-5 col-xl-3 border-right"
                        style="border-right: 1px solid #dee2e6!important;">

                        <div class="px-4 d-none d-md-block">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <input type="text" class="form-control my-3" placeholder="Search...">
                                </div>
                            </div>
                        </div>

                        {% for chat in chats_info.recent_chats %}
                        {% with username=chat.username profile_photo=chat.profile_photo %}
                        {% include 'main/templates/contact-to-chat.html' %}
                        {% endwith %}
                        {% endfor %}


                        <hr class="d-block d-lg-none mt-1 mb-0">
                    </div>
                    <div class="col-12 col-lg-7 col-xl-9">
                        <div class="py-2 px-4 border-bottom d-none d-lg-block">
                            <div class="d-flex align-items-center py-1">
                                <div class="position-relative">
                                    <img src="{% static chats_info.recent_chats.0.profile_photo %}"
                                        class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40">
                                </div>
                                <div class="flex-grow-1 pl-3">
                                    <strong> <a
                                            href="{% url 'profile' username=chats_info.recent_chats.0.username %}">{{chats_info.recent_chats.0.username}}</a></strong>
                                    <div class="text-muted small"><em>{{chats_info.recent_chats.0.status}}</em></div>
                                </div>

                            </div>
                        </div>

                        <div class="position-relative">
                            <div class="chat-messages p-4" id="chat-messages">
                                <div style="position: absolute;">
                                    <input type="hidden" id="chat-id" value="{{chats_info.current_chat.0.chat_id}}">
                                    <input type="hidden" id="user-id" value="{{user.id}}">
                                    <input type="hidden" id="profile-photo" value="{{user_info.profile_photo}}">
                                    <input type="hidden" id="username" value="{{user.username}}">
                                </div>

                                {% for message in chats_info.current_chat %}
                                {% with text=message.text date=message.date profile_photo=message.profile_photo %}
                                {% if message.sent_by == user.id %}

                                {% include 'main/templates/your-message.html' %}

                                {% else %}

                                {% include 'main/templates/other-person-message.html' %}

                                {% endif %}
                                {% endwith %}
                                {% endfor %}

                            </div>
                        </div>

                        <div class="flex-grow-0 py-3 px-4 border-top">
                            <form action="" id="send-message-form" autocomplete="off">
                                <div class="input-group" >
                                    {% csrf_token %}
                                    <input autocapitalize="True" id='text-input' type="text" class="form-control"
                                        placeholder="Type your message" style="height: 40px;">
                                    <button type="submit" class="btn btn-primary">Send</button style="height: 40px;">
                                </div>
                            </form>

                        </div>

                    </div>
                </div>
            </div>
        </div>
    </main>
</body>

</html>